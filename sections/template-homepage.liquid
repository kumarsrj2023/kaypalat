<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script src="https://www.youtube.com/iframe_api"></script>

<div class="banner-section">
  <div class="swiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide">
        <div
          class="!bg-cover flex items-center md:justify-start justify-center w-full bg-no-repeat h-screen"
          style="background: url('{{ 'banner-bg.webp' | asset_url }}');"
        >
          <div class="banner-content md:px-24 p-5 md:text-start text-center md:bg-transparent bg-white">
            <div class="vendor-name">
              <span>Kayapalat</span>
            </div>
            <div>
              <h2 class="md:text-6xl text-2xl font-semibold mb-4">New Aqua Cleanser</h2>
            </div>
            <div>
              <a
                class="bg-[#9670b0] inline-block md:text-lg text-base font-semibold px-6 py-3 w-44 text-center text-white rounded"
                href=""
                >Shop Now</a
              >
            </div>
          </div>
        </div>
      </div>

      <div class="swiper-slide">
        <div
          class="!bg-cover flex items-center md:justify-start justify-center w-full bg-no-repeat h-screen"
          style="background: url('{{ 'banner-bg-2.webp' | asset_url }}');"
        >
          <div class="banner-content md:px-24 p-5 md:text-start text-center md:bg-transparent bg-white">
            <div class="vendor-name">
              <span>Kayapalat</span>
            </div>
            <div>
              <h2 class="md:text-6xl text-2xl font-semibold mb-4">New Aqua Cleanser</h2>
            </div>
            <div>
              <a
                class="bg-[#9670b0] inline-block md:text-lg text-base font-semibold px-6 py-3 w-44 text-center text-white rounded"
                href=""
                >Shop Now</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="top-category overflow-hidden bg-[#FBF5ED] p-10">
  <div class="mb-10">
    <h2 class="text-center text-2xl font-semibold mb-10">Explore Top Categories</h2>
  </div>

  <div class="swiper-top-category overflow-hidden">
    <div class="swiper-wrapper">
      {% for collection in collections %}
        {% if collection.handle != 'frontpage' %}
          <div class="swiper-slide">
            <div class="group collection-wrapper text-center overflow-hidden">
              {% if collection.featured_image != blank %}
                {% assign collection_image = collection.featured_image %}
              {% else %}
                {% assign collection_image = collection.products.first.image %}
              {% endif %}

              <a class="inline-block" href="{{ collection.url }}">
                <div class="w-40 h-40 mb-4 mx-auto overflow-hidden rounded-full">
                  <img
                    class="object-cover w-full h-full rounded-full transform transition-transform duration-1000 ease-in-out group-hover:scale-110"
                    src="{{ collection_image | img_url: 'medium' }}"
                    width=""
                    height=""
                  >
                </div>
                <p class="text-base text-center font-medium">{{ collection.title }}</p>
              </a>
            </div>
          </div>
        {% endif %}
      {% endfor %}

      <!-- Duplicate the slides for looping -->
      {% for collection in collections %}
        {% if collection.handle != 'frontpage' %}
          <div class="swiper-slide">
            <div class="group collection-wrapper text-center overflow-hidden">
              {% if collection.featured_image != blank %}
                {% assign collection_image = collection.featured_image %}
              {% else %}
                {% assign collection_image = collection.products.first.image %}
              {% endif %}

              <a class="inline-block" href="{{ collection.url }}">
                <div class="w-40 h-40 mb-4 mx-auto overflow-hidden rounded-full">
                  <img
                    class="object-cover w-full h-full rounded-full transform transition-transform duration-1000 ease-in-out group-hover:scale-110"
                    src="{{ collection_image | img_url: 'medium' }}"
                    width=""
                    height=""
                  >
                </div>
                <p class="text-base text-center font-medium">{{ collection.title }}</p>
              </a>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div class="pillers-of-kaypalat overflow-hidden bg-[#FBF5ED] py-10 px-5">
  <div class="mb-10 text-center">
    <h2 class="text-26 font-semibold mb-2">Pillars Of Kayapalat</h2>
    <p class="text-sm font-normal">
      Naturopathy is the main base of KAYAPALAT Products. <br>
      There are 3 Pillars of Kayapalat are as below.
    </p>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    {% for i in (1..3) %}
      <!-- Thumbnails and Popup Structure -->
      <div>
        <div class="video-card" data-video-url="https://youtu.be/HUsQEuqj4ek">
          <div class="video-thumbnail-wrapper relative border-4 border-custom-skyblue">
            <img
              src="{{ 'mud-therapy.jpg' | asset_url }}"
              alt="Thumbnail"
              width="100%"
              height="100%"
              class="video-thumbnail"
            >
            <span class="absolute top-0 left-0 bottom-0 right-0 flex justify-center items-center play-btn cursor-pointer">
              {% render 'icon-video-player' %}
            </span>
          </div>
          <p class="text-lg font-semibold text-custom-skyblue text-center py-4">Mud Therapy</p>
        </div>

        <div
          id="videoPopup"
          class="video-popup hidden fixed top-0 left-0 w-screen h-screen flex justify-center items-center z-[1000] bg-gray-900/50"
        >
          <div class="video-popup-content rounded-lg relative overflow-hidden w-[80vw] h-[80vh] bg-gray-700">
            <span class="close absolute top-3 right-3 text-[2rem] text-white cursor-pointer">&times;</span>
            <div id="popupPlayer" class="popup-player h-full w-full"></div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<div class="best-sellers overflow-hidden bg-[#FBF5ED] py-10 px-5">
  <div class="mb-10 text-center">
    <h2 class="text-26 font-semibold mb-2">Best Sellers</h2>
    <p class="text-sm font-normal">Found the best sellers of the KAYAPALAT</p>
  </div>

  <div class="product-list grid grid-cols-1 md:grid-cols-3">
    {% for i in (1..8) %}
      <div>
        <div class="thumbnail h-96">
          <img
            class="h-full w-full object-cover"
            src="{{ 'product1.png' | asset_url }}"
            alt="Product Title"
            width="100%"
            height="100%"
          >
        </div>

        <div class="vendor">
          <span class="capitalize text-">Kayapalat Care</span>
        </div>

        <div class="product-title">
          <span>Mud Face Wash</span>
        </div>

        <div class="price">
          <span>{{ 19 | money }}</span>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<!-- Repeat for other videos -->

<script>
  const swiper = new Swiper('.swiper', {
    direction: 'horizontal',
    loop: true,
    effect: 'fade',
    fadeEffect: {
      crossFade: true, // Optional: smooth fade between slides
    },
  });

  // swiper-top-category
  document.addEventListener('DOMContentLoaded', function () {
    const swiper = new Swiper('.swiper-top-category', {
      slidesPerView: 6,
      spaceBetween: 10,
      loop: true,
      mousewheel: true,
      autoplay: {
        delay: 3000,
      },
    });
  });
</script>

<script>
  var popupPlayer;
  var videoPopup = document.getElementById('videoPopup');
  var closeButton = document.querySelector('.video-popup .close');

  function youtube_parser(url) {
    var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
    var match = url.match(regExp);
    return match && match[7].length === 11 ? match[7] : false;
  }

  // Initialize YouTube API
  function onYouTubeIframeAPIReady() {
    // Add event listener for play buttons
    var playButtons = document.querySelectorAll('.play-btn');

    playButtons.forEach(function (button) {
      var videoCard = button.closest('.video-card');
      var videoUrl = videoCard.getAttribute('data-video-url');
      var videoId = youtube_parser(videoUrl);

      button.addEventListener('click', function () {
        // Show the popup
        videoPopup.classList.remove('hidden');

        // Create and configure the YouTube player in the popup
        if (!popupPlayer) {
          popupPlayer = new YT.Player('popupPlayer', {
            height: '100%',
            width: '100%',
            videoId: videoId,
            playerVars: {
              controls: 1,
              autoplay: 1,
              rel: 0,
              showinfo: 0,
            },
          });
        } else {
          popupPlayer.loadVideoById(videoId);
          popupPlayer.playVideo();
        }
      });
    });

    // Close the popup when the close button is clicked
    closeButton.addEventListener('click', function () {
      videoPopup.classList.add('hidden');
      if (popupPlayer) {
        popupPlayer.stopVideo();
      }
    });
  }
</script>
